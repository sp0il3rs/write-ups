<!DOCTYPE html>
<html class="gr__ashishchaudhary_in">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Team Sp0il3rs">
<title>Spoilers | CTF Writeups</title>
<link rel="stylesheet" href="writeups.css">
<title>Spoilers | CTF Writeups</title>
<meta property="og:title" content="Spoilers | CTF Writeups">
<meta name="author" content="Team Sp0il3rs">
<meta property="og:locale" content="en_US">
<meta name="description" content="A CTF Blog from Team Sp0il3rs">
<meta property="og:description" content="A CTF Blog from Team Sp0il3rs">
<meta property="og:url" content="https://sp0il3rs.github.io/sp0il3rs/">
<meta property="og:site_name" content="Sp0il3rs | CTF Writeups">
<link rel="next" href="https://sp0il3rs.github.io/sp0il3rs/">
<script type="application/ld+json">
{"name":"Spoilers | CTF Writeups","description":"A CTF Blog from Team Sp0il3rs","author":{"@type":"Team","name":"sp0il3rs"},"@type":"WebSite","url":"https://sp0il3rs.github.io/sp0il3rs/","image":null,"publisher":null,"headline":"Team sp0il3rs","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<style>
#popup {
		display:none;
		position:absolute;
		margin:0 auto;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		z-index: 9999;
    }
</style>
</head>
<body data-gr-c-s-loaded="true">
<div id="wrapper">
<header>
<div>
<a href="https://sp0il3rs.github.io/sp0il3rs/">
<h1>spoilers</h1>
</a>
<p><center>c3BvaWxlcnNfbmV2ZXJfZ2l2ZV91cA==</center></p>
<div class="header-links">
<a href="https://sp0il3rs.github.io/write-ups/"><h2 class="header-link">CTF Writeups</h2></a>&nbsp;&nbsp;<!--<a href="tools.html"><h2 class="header-link">CTF Tools</h2></a>-->
</div>
<p><a href="#nactf">NACTF 2019</a>&nbsp;&nbsp;&nbsp;<a href="#newbiectf">Newbie CTF 2019</a>&nbsp;&nbsp;&nbsp;<a href="#ritsecctf">RITSEC CTF 2019</a>&nbsp;&nbsp;&nbsp;<a href="#utcctf">UTC CTF 2019</a>&nbsp;&nbsp;&nbsp;<a href="#kafctf">KAF CTF 	2019</a></p>
</div>
</header>
<div class="container">
<section id="main_content">
<ul>
<li>
<h2 id="nactf">NACTF - Sep 2019</h2>
<h2>Web</h2>
<h3><u>Pink Panther - 50</u></h3>
<p>Rahul loves the Pink Panther. He even made this website: http://pinkpanther.web.2019.nactf.com</p>
<p>I think he hid a message somewhere on the webpage, but I don't know where... can you INSPECT and find the message?</p>
<h4>Solution</h4>
<p>Open the given <a href="http://pinkpanther.web.2019.nactf.com">link</a> and view-source of the website</p>
<br>
<h3><u>Scooby Doo - 100</u></h3>
<p>Kira loves to watch Scooby Doo so much that she made a website about it! She also added a clicker game which looks impossible.</p>
<p>Can you use your inspector skills from Pink Panther to reveal the flag?</p>
<p>http://scoobydoo.web.2019.nactf.com</p>
<h4>Solution</h4>
<p>Open the given <a href="http://scoobydoo.web.2019.nactf.com/game.html">link</a> view-source</p>
<p>To get flag, we need to change the opacity of &lt;img&gt; tags to 1</p>
<br>
<h3><u>Dexter's Lab - 125</u></h3>
<p>Please check in on your brother's lab at https://dexterslab.web.2019.nactf.com We know his username is Dexter,</p>
<p>but we don't know his password! Maybe you can use a SQL injection? Mom + Dad</p>
<h4>Solution</h4>
<p>Open the given <a href="https://dexterslab.web.2019.nactf.com">link</a></p>
<p>To get flag, we need to login to the site with username dexter and password <code>1' OR '1'='1</code> a basic SQL Injection</p>
<br>
<h3><u>Sasame street - 150</u></h3>
<p>Surprisingly, The20thDuck loves cookies! He also has no idea how to use php.</p>
<p> He accidentally messed up a cookie so it's only available on the countdown page... Also why use cookies in the first place?</p>
<p>http://sesamestreet.web.2019.nactf.com/</p>
<h4>Solution</h4>
<p>Open the given <a href="http://sesamestreet.web.2019.nactf.com">link</a></p>
<p>Go to http://sesamestreet.web.2019.nactf.com/countdown.php. Edit cookie session-time, </p>
<p>change the Path to flag.php, change the value to a large number such as 2568986265. </p>
<p>Finally, go to http://sesamestreet.web.2019.nactf.com/flag.php, we will get flag</p>
</li>
</ul>
</section><br>
<section id="main_content">
<ul>
<li>
<h2 id="newbiectf">Newbie CTF - Nov 2019</h2>
<h2>Forensics</h2>
<h3 id="topsecret"><u>Top Secret - 643</u></h3>
<p>He stole the virtual machine file containing the top secret of the enemy country.</p>
<p>However, due to the shortage of USB memory, I dumped only the memory that seemed to be the most important. </p>
<p>What is the secret of an enemy country? (Fake Flag file exists.)</p>
<p>https://drive.google.com/file/d/1eQMKWR8y-c2zPzqZFmncj0h8S7advhSm/view?usp=sharing</p>
<h4>Solution</h4>
<p>Download the given <a href="https://drive.google.com/file/d/1eQMKWR8y-c2zPzqZFmncj0h8S7advhSm/view?usp=sharing">File</a></p>
<p>The file is VMEM which is a virtual memory (RAM of virtual device)</p>
<p>To analyse VMEM files, we can use <a href="https://www.volatilityfoundation.org/26">Volatility tool</a> with this <a href="https://github.com/volatilityfoundation/volatility/wiki/Command-Reference">Reference</a></p>
<p>But we can also solve this task by simply finding strings since we know the flag format </p>
<p><code><i>strings "Windows 7 Enterprise K-b94208dd.vmem" | grep -oE "KorNewbie{.*}"</i></code></p>
<br>
<h3 id="chat"><u>Chat - 980</u></h3>
<p>Confidential information came and went through chat. Find the email of the user who used the chat.</p>
<p>Flag: KorNewbie{email_address}</p>
<p><a href="https://drive.google.com/open?id=1Gfz5e-rwDSz14MWPfhGBfKHqfAjPGVXX">https://drive.google.com/open?id=1Gfz5e-rwDSz14MWPfhGBfKHqfAjPGVXX</a></p>
<p></p>
<h4>Solution</h4>
<p>Download the given <a href="https://drive.google.com/open?id=1Gfz5e-rwDSz14MWPfhGBfKHqfAjPGVXX">File</a></p>
<p>The file contains Windows 10 Virtual Machine which can be imported to VMware or Virtual Box</p>
<p>Since no password has been provided for windows 10 virtual machines, we have to bypass the windows password</p>
<p>After bypassing windows password goto recent files in <b>This PC</b>. we find a Document named <b>"last_pc_login.dat"</b></p>
<p>Open the file "last_pc_login.dat" and you will find the required email addresss</p>
<br>
</li>
</ul>
</section>
<section id="main_content">
<ul>
<li>
<h2 id="ritsecctf">RITSEC CTF - Nov 2019</h2>
<h2>Web</h2>
<h3 id="misdirection"><u>Misdirection - 100</u></h3>
<p>Looks like someone gave you the wrong directions!</p>
<p>http://ctfchallenges.ritsec.club:5000/</p>
<p>Flag format is RS{ }</p>
<h4>Solution</h4>
<p>Open the given <a href="http://ctfchallenges.ritsec.club:5000/">Link</a> in Burp proxy</p>
<p>We can observe the page redirects several times</p>
<p>Analyse the pages at Burp - Proxy - HTTP History, we can see the redirected pages have single charaters R, S, %7B, 4, etc. which is in our RI{} flag format</p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/
	s/burp.png" width="980px" height="720px"></p>
<h3 id="buckets"><u>Buckets of Fun - 100</u></h3>
<p>http://bucketsoffun-ctf.s3-website-us-east-1.amazonaws.com/</p>
<h4>Solution</h4>
<p>Open the given <a href="http://bucketsoffun-ctf.s3-website-us-east-1.amazonaws.com/">Link</a></p>
<p>It’s clear that the challenge has something to do with aws s3 buckets as per challage name & URL</p>
<p>May be the aws bucket has flag file</p>
<p>Open the base aws s3 link at <a href="http://bucketsoffun-ctf.s3.amazonaws.com/">http://bucketsoffun-ctf.s3.amazonaws.com/</a></p>
<p>Here we can observe the following source code</p>
<code>
<em>
	<ListBucketResult><br>
	<Name>bucketsoffun-ctf</Name><br>
	<Prefix/><br>
	<Marker/><br>
	<MaxKeys>1000</MaxKeys><br>
	<IsTruncated>false</IsTruncated><br>
	<Contents><br>
	<Key>index.html</Key><br>
	<LastModified>2019-11-18T14:05:20.000Z</LastModified><br>
	<ETag>"b271e7783d480770f61670d6b234e1ed"</ETag><br>
	<Size>630</Size><br>
	<StorageClass>STANDARD</StorageClass><br>
	</Contents><br>
	<Contents><br>
	<Key>youfoundme-asd897kjm.txt</Key><br>
	<LastModified>2019-11-18T14:05:20.000Z</LastModified><br>
	<ETag>"a920cc3c8aaa05c1afe96a78d0adbcda"</ETag><br>
	<Size>25</Size><br>
	<StorageClass>STANDARD</StorageClass><br>
	</Contents><br>
	</ListBucketResult><br>
</em>
</code>
<p>There is a file <strong>youfoundme-asd897kjm.txt</strong> which has required flag</p>
</li>
<br>
</ul>
</section>
<section id="main_content">
<ul>
<li>
<h2 id="utcctf">UTC CTF - Dec 2019</h2>
<h2>Misc</h2>
<h3 id="ezip"><u>ezip - 31</u></h3>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/ezip.PNG" width="360px" height="360px"></p>
<p>Given two files <a href="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/files/flag.zip">flag.zip</a> and <a href="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/files/cat.png">cat.png</a></p>
<h4>Solution</h4>
<p>Analyse both the file</p>
<p>flag.zip is password protected and we need to crack the password by using tools such as fcrackzip</p>
<p>But we have another file cat.png, by analyzing this image using exiftool we can find flag.zip's password</p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/cat.PNG" width="360px" height="300px"></p>
<p>Use the password to unzip the flag.zip and we get flag.txt which contains our required flag</p>
<br>
<h3 id="optics1"><u>Optics 1 - 42</u></h3>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/optics.PNG" width="360px" height="360px"></p>
<p>Given an image <a href="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/files/challange1.png">Challange1.png</a> but there is an error opening the image</p>
<h4>Solution</h4>
<p>Analyse the image header using XXD in linux or any other Hexeditor</p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/xxd.PNG" width="360px" height="300px"></p>
<p>The png header is .PNG but here it is .LOL</p>
<p>Edit and change the .LOL header to .PNG by using Hexeditor and save the image</p>
<p>Now try to open the saved images we get a QR code scan it and get the flag</p>
<br>
<h2>Reverse Engineering &hearts;</h2>
<h3 id="strings"><u>Strings - 26</u></h3>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/strings.PNG" width="360px" height="360px"></p>
<p>The <a href="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/files/strings">strings</a> file is an ELF executable</p>
<h4>Solution</h4>
<p>Since the title of the challange says <strong>Strings</strong></p>
<p>Search for strings using strings command</p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/stringssol.PNG" width="360px" height="300px"></p>
<p><em>Note: There is also a fake flag <strike>utc{fakeflag}</strike></em></p>
<br>
<h3 id="coredump1"><u>Corey's core dump 1 - 35</u></h3>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/coredump1.PNG" width="360px" height="420px"></p>
<p>The <a href="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/files/core">core</a> file is an ELF executable</p>
<h4>Solution</h4>
<p>First things first, always try to find and understand the executable file</p>
<p>Here the ELF file cannot run</p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/coreerr.PNG" width="550px" height="70px"></p>
<p>Lets run strings same as previous challange</p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/coresol.PNG" width="550px" height="70px"></p>
<p><em>Strings is a saviour</em></p>
<br>
<h3 id="jump"><u>Jump - 70</u></h3>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/jump.PNG" width="360px" height="360px"></p>
<p>The <a href="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/files/jump">jump</a> file is an ELF executable</p>
<h4>Solution</h4>
<p><em>Level up, no strings this time</em></p>
<p>Run the file we get a fake flag</p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/jumprunfake.PNG" width="550px" height="50px"></p>
<p>Lets start analysing the file using radare2</p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/r2.PNG" width="600px" height="600px"></p>
<p>There is a function called <em>sym.gimme_flag</em> but that function is not included in the main function</p>
<p>So we have to make a jump to that <em>sym.gimme_flag</em> function to obtain the flag</p>
<p>Let's start by setting a break point at starting of main</p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/r2breakmain.PNG" width="650px" height="400px"></p>
<p>Now Seek to <em>sym.gimme_flag</em> function</p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/seek.PNG" width="650px" height="400px"></p>
<p>Run the binary using <em>dc</em> command it hits the break point at main</p>
<p>Now jump to function <em>sym.gimme_flag</em> using command <em>dr rip=0x55680b9936fa</em> (Starting address of sym.gimme_flag function)</p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/jumptoflag.PNG" width="650px" height="100px"></p>
<p>If we analyse carefully there is another jump to make inorder to get the flag</p>
<p>In <em>sym.gimme_flag</em> function there is <em>je 0x55680b993766</em> which doesnot take the jump</p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/noje.PNG" width="800px" height="200px"></p>
<p>So set another break point at <em>je 0x55680b993766</em> which as address <em>0x55680b99374e</em></p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/db43.PNG" width="800px" height="60px"></p>
<p>Run the binary again using <em>dc</em> it hits the break point again, now jump to 0x55680b993766 address using command <em>dr rip=0x55680b993766</em></p>
<p>Again run <em>dc</em> to get the flag</p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/last.PNG" width="700px" height="300px"></p>
<br>
</li>
</ul>
</section>
<section id="main_content">
<ul>
<li>
<h2 id="kafctf">Kipod After Free CTF - Dec 2019</h2>
<h2>Web</h2>
<h3 id="cookieclicker"><u>Cookie Clicker - 25</u></h3>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/cookie.PNG" width="460px" height="360px"></p>
<h4>Solution</h4>
<p>Go to the given link and sign in with a username</p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/click.PNG" width="460px" height="360px"><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/spoil.PNG" width="460px" height="360px"></p>
<p>If we click <code>1000000</code> times we get the flag; LOL</p>
<p>Challange Tags: Cookie, JWT, rock says we have to crack the JWT cookie using rockyou.txt as wordlist</p>
<p>Copy the cookie from browser<p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/jwtcookie.PNG" width="560px" height="360px"></p>
<p>Go to <a href="https://jwt.io/">www.jwt.io</a> debugger and analyse the JWT cookie</p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/JWTIO.PNG" width="560px" height="360px"></p>
<p>To obtain flag we have to change the "clickCounter" value from "0" to "1000000", to do this we have to first crack the JWT secret key to get valid JWT signature</p>
<p>We can crack JWT secret key using John the Ripper, but first we have to convert JWT to a valid John the Ripper hash</p>
<p>Go to <a href="https://github.com/MarcoLugo/jwt2jtr">link</a> download the file jwt2jtr.py</p>
<p>Using command <em>python jwt2jtr.py  eyJhbGciOiJIUzI1NiIsInR5cCI6I...........Z6Rttqj40k6oeGrPVXm0</em> convert JWT to John the Ripper hash<p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/jwttojhon.PNG" width="960px" height="260px"></p>
<p>Copy the generated hash to a file for example: jwt.hash and crack it with using John the Ripper using command <em>john jwt.hash --wordlist=rockyou.txt</em></p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/johncrack.PNG" width="960px" height="360px"></p>
<p>Now generate new JWT token from <a hre="https://jwt.io/">jwt.io</a> using cracked secret key <em>mypinkipod</em> by changing clickCounter value from <code>0</code> to <code>1000000</code>, if cookie expired change the <em>"exp": </em> value also</p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/cracked.PNG" width="860px" height="460px"></p>
<p>Finally copy and paste the obtained JWT cookie from <a href="https://jwt.io/">JWT.io</a> to our challange website and refresh the page.</p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/flagcookie.PNG" width="560px" height="360px"></p>
<p>Voila! there is our flag..!</p>
<br>
<h2>Misc</h2>
<h3 id="tupper"><u>Tupper - 5</u></h3>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/tupper.PNG" width="460px" height="360px"></p>
<p><a href="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/files/k.txt">K Value</a></p>
<p>A simple challange, just goto <a href="https://keelyhill.github.io/tuppers-formula/">link</a> and Copy/Paste the K value</p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/k.PNG" width="760px" height="260px"></p>
<br>
<h3 id="dinary"><u>Dinary - 15</u></h3>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/dinary.PNG" width="460px" height="360px"></p>
<p>The <a href="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/files/dinary.png">dinary</a> file is a valid PNG, but by analysing the png with binwalk there is some Zlib compressed data</p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/dinart1.PNG" width="760px" height="260px"></p>
<p>Lets use zsteg to extract the zlib compressed data</p>
<p><img src="https://raw.githubusercontent.com/sp0il3rs/write-ups/master/images/dinarysol.PNG" width="1060px" height="70px"></p>
<p>And we got the flag !</p>
</li>
</ul>
</section>
</div>
<div class="pagination">
<!--<span class="page-item">«</span>-->
<!--<span class="page-item">1</span>-->
<!--<a href="" class="page-item">2</a>-->
</div>
<footer>
<span>
<b>Developed and Maintained by <a href="http://www.putravenkataraju.me">mrpvr</a></b><br><b><a href="https://sp0il3rs.github.io/sp0il3rs/">sp0il3rs</b>
</span>
<span>© 2019</span>
</a>
</footer>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
</body></html>
